{"remainingRequest":"D:\\1\\egg-lottery-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\1\\egg-lottery-master\\src\\App.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\1\\egg-lottery-master\\src\\App.vue","mtime":1670386259562},{"path":"D:\\1\\egg-lottery-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670231408046},{"path":"D:\\1\\egg-lottery-master\\node_modules\\babel-loader\\lib\\index.js","mtime":1670231408036},{"path":"D:\\1\\egg-lottery-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1670231408046},{"path":"D:\\1\\egg-lottery-master\\node_modules\\vue-loader\\lib\\index.js","mtime":1670231437653}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQovLyBpbXBvcnQgYW5pbWF0aW9uLCB7IGJhbGxzUG9zaXRpb25zIH0gZnJvbSAiLi91dGlsL2FuaW1hdGlvbiI7DQppbXBvcnQgew0KICBQUklaRVNfTElTVCwNCiAgUFJJWkVTX1dFSUdIVF9MSVNULA0KICBMT1RURVJZX1RJTUVTDQp9IGZyb20gIi4vYXBpL2luaXREYXRhIjsNCmltcG9ydCBTdG9yYWdlIGZyb20gIi4vc3RvcmFnZS9pbmRleCI7DQppbXBvcnQgSGVscGVyIGZyb20gIi4vdXRpbC9oZWxwZXIiOw0KaW1wb3J0IERyYXdCYWxsIGZyb20gIi4vY29tcG9uZW50cy9EcmF3QmFsbCI7DQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogIkFwcCIsDQogIGNvbXBvbmVudHM6IHsNCiAgICBEcmF3QmFsbCwNCiAgfSwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgcHJvY2Vzc2luZzogZmFsc2UsIC8vIOaYr+WQpuato+WcqOaKveWlluS4rQ0KICAgICAgc2hvd0RyYXdCYWxsOiBmYWxzZSwgLy8g5byA5aWWIOaYr+WQpuaYvuekug0KICAgICAgc2hvd1ByaXplQm94OiBmYWxzZSwgLy8g5Ye65aWWIOaYr+WQpuaYvuekug0KICAgICAgc2hvd2JhbGxzOiB0cnVlLA0KICAgICAgdG90YWxUaW1lczogMCwgLy8g5oC76I635b6X55qE5oq95aWW5qyh5pWwDQogICAgICB1c2VkVGltZXM6IDAsIC8vIOW3suS9v+eUqOeahOaKveWlluasoeaVsA0KICAgICAgYXdhcmREYXRhOiB7fSwgLy8g5Lit5aWW5aWW5ZOB6K+m5oOFDQogICAgICBhd2FyZExpc3Q6IFtdLCAvLyDlpZblk4HliJfooagNCiAgICAgIHByaXplX2xpc3Q6UFJJWkVTX0xJU1QsDQogICAgICBjZW50YmFsbDpmYWxzZSwNCiAgICAgIHNob3dib3hiYWxsOmZhbHNlDQogICAgfTsNCiAgfSwNCiAgY29tcHV0ZWQ6IHsNCiAgICAvLyDliankvZnmir3lpZbmrKHmlbANCiAgICB1c2FibGVUaW1lcygpIHsNCiAgICAgIHJldHVybiB0aGlzLnRvdGFsVGltZXMgLSB0aGlzLnVzZWRUaW1lczsNCiAgICB9LA0KICB9LA0KICBjcmVhdGVkKCkgew0KICAgIGxldCB7IHRvdGFsVGltZXMsIGF3YXJkTGlzdCB9ID0gU3RvcmFnZS5nZXRTdG9yYWdlKCk7DQogICAgdGhpcy50b3RhbFRpbWVzID0gTE9UVEVSWV9USU1FUzsNCiAgICBTdG9yYWdlLnNldEl0ZW0oInRvdGFsVGltZXMiLCB0aGlzLnRvdGFsVGltZXMpOw0KICAgIFN0b3JhZ2Uuc2V0SXRlbSgidXNlZFRpbWVzIiwgMCk7DQogICAgDQogICAgdGhpcy50b3RhbFRpbWVzID0gU3RvcmFnZS5nZXRJdGVtKCJ0b3RhbFRpbWVzIik7DQogICAgdGhpcy51c2VkVGltZXMgPSBTdG9yYWdlLmdldEl0ZW0oInVzZWRUaW1lcyIpOw0KDQogICAgLy8g5pys5Zyw6I635Y+W5Lit5aWW5pWw5o2uDQogICAgaWYgKGF3YXJkTGlzdCAhPT0gdW5kZWZpbmVkKSB7DQogICAgICB0aGlzLmF3YXJkTGlzdCA9IGF3YXJkTGlzdDsNCiAgICB9DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBfZmluZVR5cGUodHlwZSkgew0KICAgICAgcmV0dXJuIHRoaXMuYXdhcmRMaXN0LnNvbWUoKGkpID0+IGkudHlwZSA9PT0gdHlwZSk7DQogICAgfSwNCg0KICAgIF9sb3R0ZXJ5KCkgew0KICAgICAgLy8g5oC75p2D6YeN5LmL5ZKMDQogICAgICBjb25zdCB3ZWlnaHRTdW0gPSBQUklaRVNfV0VJR0hUX0xJU1QucmVkdWNlKChwcmV2LCBzdW0pID0+IHByZXYgKyBzdW0sIDApOw0KICAgICAgLy8g55Sf5oiQ5LiA5Liq5p2D6YeN6ZqP5py65pWw77yM5LuL5LqOMC13ZWlnaHRTdW3kuYvpl7QNCiAgICAgIGxldCByYW5kb20gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiB3ZWlnaHRTdW0pICsgMTsNCiAgICAgIC8vIOiuoeeul+adg+mHjemaj+acuuaVsOWcqOaVsOe7hOS4reS9jee9rg0KICAgICAgbGV0IHN1bSA9IDA7DQogICAgICBsZXQgaSA9IDA7DQogICAgICBmb3IgKDsgaSA8IFBSSVpFU19XRUlHSFRfTElTVC5sZW5ndGg7IGkrKykgew0KICAgICAgICBzdW0gKz0gUFJJWkVTX1dFSUdIVF9MSVNUW2ldOw0KICAgICAgICBpZiAocmFuZG9tIDw9IHN1bSkgYnJlYWs7DQogICAgICB9DQogICAgICAvLyDlsIbmir3lpZbnu5PmnpzlrZjlgqjliLDmnKzlnLANCiAgICAgIHRoaXMuX3N0b3JpbmdEYXRhKA0KICAgICAgICBPYmplY3QuYXNzaWduKFBSSVpFU19MSVNUW2ldLCB7DQogICAgICAgICAgdGltZTogbmV3IERhdGUoKS50b0xvY2FsZURhdGVTdHJpbmcoKSwNCiAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkuZ2V0VGltZSgpLA0KICAgICAgICB9KQ0KICAgICAgKTsNCiAgICANCiAgICAgICAgDQogICAgICAvLyDlkIzmraXpobXpnaLmlbDmja7muLLmn5MNCiAgICAgIHRoaXMuYXdhcmRMaXN0ID0gU3RvcmFnZS5nZXRJdGVtKCJhd2FyZExpc3QiKTsNCg0KICAgICAgLy8g6L+U5Zue5oq95aWW57uT5p6cDQogICAgICByZXR1cm4gUFJJWkVTX0xJU1RbaV07DQogICAgfSwNCiAgICBfc3RvcmluZ0RhdGEoZGF0YSkgew0KICAgICAgbGV0IGF3YXJkTGlzdCA9IFN0b3JhZ2UuZ2V0SXRlbSgiYXdhcmRMaXN0Iik7DQogICAgICBpZiAoYXdhcmRMaXN0ID09PSB1bmRlZmluZWQpIHsNCiAgICAgICAgU3RvcmFnZS5zZXRJdGVtKCJhd2FyZExpc3QiLCBbZGF0YV0pOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgU3RvcmFnZS5zZXRJdGVtKCJhd2FyZExpc3QiLCBbLi4uYXdhcmRMaXN0LCBkYXRhXSk7DQogICAgICB9DQogICAgfSwNCiAgICBhc3luYyBsb3R0ZXJ5SGFuZGxlcigpIHsNCiAgICAgIHRoaXMuY2VudGJhbGwgPSB0cnVlOw0KICAgICAgdGhpcy5wcm9jZXNzaW5nID0gdHJ1ZTsgLy8g5oq95aWW5LitDQogICAgICB0aGlzLnVzZWRUaW1lcys9MjA7DQogICAgICBTdG9yYWdlLnNldEl0ZW0oInVzZWRUaW1lcyIsIHRoaXMudXNlZFRpbWVzKTsNCg0KICAgICAgdGhpcy5zaG93UHJpemVCb3ggPSBmYWxzZTsNCiAgICAgIHRoaXMuc2hvd2JveGJhbGw9dHJ1ZTsNCiAgICAgIHRoaXMuJHJlZnMuYmFsbHMuc3R5bGUuYW5pbWF0aW9uTmFtZSA9ICIiOw0KICAgICAgdGhpcy4kcmVmcy5iYWxscy5zdHlsZS5hbmltYXRpb25OYW1lID0gImJhbGxzUm9sbGluZyI7DQoNCiAgICAgIGF3YWl0IEhlbHBlci53YWl0KDEwMDApOyANCiAgICAgIHRoaXMuc2hvd1ByaXplQm94ID0gdHJ1ZTsNCiAgICAgIGF3YWl0IEhlbHBlci53YWl0KDgwMCk7DQogICAgICB0aGlzLnNob3dQcml6ZUJveCA9IGZhbHNlOw0KICAgICB0aGlzLnNob3dib3hiYWxsPWZhbHNlOw0KICAgICAgdGhpcy5zaG93RHJhd0JhbGwgPSB0cnVlOw0KICAgICAgdGhpcy5jZW50YmFsbD1mYWxzZTsNCiAgICAgIHRoaXMuYXdhcmREYXRhID0gdGhpcy5fbG90dGVyeSgpOw0KDQogICAgICB0aGlzLiRyZWZzLmJhbGxzLnN0eWxlLmFuaW1hdGlvbk5hbWUgPSAiIg0KICAgIH0sDQogICAgaGlkZURyYXdCYWxsSGFuZGxlcigpIHsNCiAgICAgIHRoaXMucHJvY2Vzc2luZyA9IGZhbHNlOw0KICAgICAgdGhpcy5zaG93RHJhd0JhbGwgPSBmYWxzZTsNCiAgICB9LA0KICAgIGFsZXJ0VGlwKHRpcCkgew0KICAgICAgYWxlcnQodGlwKTsNCiAgICB9LA0KICB9LA0KfTsNCg=="},{"version":3,"sources":["App.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"App.vue","sourceRoot":"src","sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <!-- 转盘 -->\r\n    <div class=\"content\">\r\n      <div class=\"starleft\"></div>\r\n      <div class=\"starright\"></div>\r\n      <div class=\"title1\"></div>\r\n      <div class=\"machine-botton\"></div>\r\n      <div class=\"box-ballupDown\" v-show=\"showboxball\" >\r\n        <div class=\"box-ball1\"></div>\r\n        <div class=\"box-ball2\"></div>\r\n        <div class=\"box-ball3\"></div>\r\n        <div class=\"box-ball4\"></div>\r\n        <div class=\"box-ball5\"></div>\r\n        <div class=\"box-ball6\"></div>\r\n      </div>\r\n      <div class=\"machine\"></div>\r\n        <div ref=\"balls\" v-show=\"showballs\" class=\"balls\">\r\n          <div :class=\"'ball1 '+(centball?'centball':'divergeball')\">\r\n            <div class=\"pop1\"></div></div>\r\n          <div :class=\"'ball2 '+(centball?'centball':'divergeball')\"><div class=\"pop2\"></div></div>\r\n          <div :class=\"'ball3 '+(centball?'centball':'divergeball')\"><div class=\"pop3\"></div></div>\r\n          <div :class=\"'ball4 '+(centball?'centball':'divergeball')\"><div class=\"pop3\"></div></div>\r\n          <div :class=\"'ball5 '+(centball?'centball':'divergeball')\"><div class=\"pop4\"></div></div>\r\n          <div :class=\"'ball6 '+(centball?'centball':'divergeball')\"><div class=\"pop4\"></div></div>\r\n        </div>\r\n        <button\r\n          @click=\"lotteryHandler\"\r\n          class=\"btn-lottery\"\r\n          :disabled=\"usableTimes < 1 || processing\"\r\n        >开始抽奖\r\n      </button>\r\n      <button class=\"btn-left\"></button>\r\n      <button class=\"btn-right\"></button>\r\n      <div class=\"coin\">×20</div>\r\n      <div class=\"tipbg\">左右按钮或滑动切换奖池</div>\r\n      <div class=\"detialbg\"></div>\r\n      <button class=\"btn-win\">\r\n        累计奖励\r\n      </button>\r\n      <div class=\"cj-timesbg\">\r\n        剩余XX数量\r\n        <div class=\"cj-times\">\r\n          <i class=\"i\">{{usableTimes}}</i>\r\n        </div>\r\n      </div>\r\n      <div class=\"ball-exit\">\r\n      </div>\r\n        <!-- 扭蛋下落 -->\r\n        <div class=\"bounce-down-ball\" v-show=\"showPrizeBox\"></div>\r\n    </div>\r\n    <!-- 我的奖品 -->\r\n    <div class=\"my-prize\">\r\n      <div class=\"top\"></div>\r\n      <ul class=\"list\">\r\n        <li v-for=\"item in awardList\" :key=\"item.timestamp\">\r\n          <span>{{ item.time }}</span>\r\n          <span>恭喜你获得</span>\r\n          <span>{{ item.name }}</span>\r\n        </li>\r\n      </ul>\r\n      <div class=\"no-awards\" v-if=\"awardList.length === 0\">暂无奖品</div>\r\n    </div>\r\n    <!-- 大扭蛋组件 -->\r\n    <draw-ball\r\n      @hideDrawBall=\"hideDrawBallHandler\"\r\n      :awardData=\"awardData\"\r\n      v-if=\"showDrawBall\"\r\n    ></draw-ball>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n// import animation, { ballsPositions } from \"./util/animation\";\r\nimport {\r\n  PRIZES_LIST,\r\n  PRIZES_WEIGHT_LIST,\r\n  LOTTERY_TIMES\r\n} from \"./api/initData\";\r\nimport Storage from \"./storage/index\";\r\nimport Helper from \"./util/helper\";\r\nimport DrawBall from \"./components/DrawBall\";\r\n\r\nexport default {\r\n  name: \"App\",\r\n  components: {\r\n    DrawBall,\r\n  },\r\n  data() {\r\n    return {\r\n      processing: false, // 是否正在抽奖中\r\n      showDrawBall: false, // 开奖 是否显示\r\n      showPrizeBox: false, // 出奖 是否显示\r\n      showballs: true,\r\n      totalTimes: 0, // 总获得的抽奖次数\r\n      usedTimes: 0, // 已使用的抽奖次数\r\n      awardData: {}, // 中奖奖品详情\r\n      awardList: [], // 奖品列表\r\n      prize_list:PRIZES_LIST,\r\n      centball:false,\r\n      showboxball:false\r\n    };\r\n  },\r\n  computed: {\r\n    // 剩余抽奖次数\r\n    usableTimes() {\r\n      return this.totalTimes - this.usedTimes;\r\n    },\r\n  },\r\n  created() {\r\n    let { totalTimes, awardList } = Storage.getStorage();\r\n    this.totalTimes = LOTTERY_TIMES;\r\n    Storage.setItem(\"totalTimes\", this.totalTimes);\r\n    Storage.setItem(\"usedTimes\", 0);\r\n    \r\n    this.totalTimes = Storage.getItem(\"totalTimes\");\r\n    this.usedTimes = Storage.getItem(\"usedTimes\");\r\n\r\n    // 本地获取中奖数据\r\n    if (awardList !== undefined) {\r\n      this.awardList = awardList;\r\n    }\r\n  },\r\n  methods: {\r\n    _fineType(type) {\r\n      return this.awardList.some((i) => i.type === type);\r\n    },\r\n\r\n    _lottery() {\r\n      // 总权重之和\r\n      const weightSum = PRIZES_WEIGHT_LIST.reduce((prev, sum) => prev + sum, 0);\r\n      // 生成一个权重随机数，介于0-weightSum之间\r\n      let random = Math.floor(Math.random() * weightSum) + 1;\r\n      // 计算权重随机数在数组中位置\r\n      let sum = 0;\r\n      let i = 0;\r\n      for (; i < PRIZES_WEIGHT_LIST.length; i++) {\r\n        sum += PRIZES_WEIGHT_LIST[i];\r\n        if (random <= sum) break;\r\n      }\r\n      // 将抽奖结果存储到本地\r\n      this._storingData(\r\n        Object.assign(PRIZES_LIST[i], {\r\n          time: new Date().toLocaleDateString(),\r\n          timestamp: new Date().getTime(),\r\n        })\r\n      );\r\n    \r\n        \r\n      // 同步页面数据渲染\r\n      this.awardList = Storage.getItem(\"awardList\");\r\n\r\n      // 返回抽奖结果\r\n      return PRIZES_LIST[i];\r\n    },\r\n    _storingData(data) {\r\n      let awardList = Storage.getItem(\"awardList\");\r\n      if (awardList === undefined) {\r\n        Storage.setItem(\"awardList\", [data]);\r\n      } else {\r\n        Storage.setItem(\"awardList\", [...awardList, data]);\r\n      }\r\n    },\r\n    async lotteryHandler() {\r\n      this.centball = true;\r\n      this.processing = true; // 抽奖中\r\n      this.usedTimes+=20;\r\n      Storage.setItem(\"usedTimes\", this.usedTimes);\r\n\r\n      this.showPrizeBox = false;\r\n      this.showboxball=true;\r\n      this.$refs.balls.style.animationName = \"\";\r\n      this.$refs.balls.style.animationName = \"ballsRolling\";\r\n\r\n      await Helper.wait(1000); \r\n      this.showPrizeBox = true;\r\n      await Helper.wait(800);\r\n      this.showPrizeBox = false;\r\n     this.showboxball=false;\r\n      this.showDrawBall = true;\r\n      this.centball=false;\r\n      this.awardData = this._lottery();\r\n\r\n      this.$refs.balls.style.animationName = \"\"\r\n    },\r\n    hideDrawBallHandler() {\r\n      this.processing = false;\r\n      this.showDrawBall = false;\r\n    },\r\n    alertTip(tip) {\r\n      alert(tip);\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style src=\"./App.scss\" lang=\"scss\"></style>\r\n"]}]}